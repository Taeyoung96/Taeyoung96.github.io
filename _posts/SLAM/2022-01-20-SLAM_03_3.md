---
title : "Slam 3-3강 (ICP & Point Cloud Registration - Non-linear Least Squares) 요약"
category :
    - Slam
tag :
    - Slam
toc : true
toc_sticky: true
comments: true
---  

## 0. Today's Goal

- Least Squares Approach 소개 및 장점  
- 2D point-to-point registration

## 1. 강의 및 강의 자료  

강의 List는 [SLAM KR](https://www.youtube.com/channel/UCXvT7auo7xUd7v0B2pmvwIA)의 SLAM DUNK seson 2에서 정해준 강의를 따라 정리를 할 것이다.  

SLAM DUNK season 2의 Reference는 [여기](https://youtube.com/playlist?list=PLubUquiqNQdMYwQVftUSFEWhJgzBErO9N)서 확인해 볼 수 있다.  

SLAM KR에서 이 강의를 듣고 요약을 세미나 형식으로 준비를 해준다!

이번 포스팅은 다음의 강의들을 참고하여 요약을 해보았다.  

Point Cloud Registration & ICP의 경우 2021 강의에서 3번에 걸쳐 나눠 강의를 진행했기 때문에  
그 강의를 듣고 요약을 진행했다.  

- [ICP & Point Cloud Registration - Part 3: Non-linear Least Squares (Cyrill Stachniss, 2021)](https://youtu.be/CJE59i8oxIE)    
- [SLAM DUNK Season 2 - Iterative Closest Points](https://youtu.be/BiQx5ISVdxU)  

Cyrill Stachniss의 강의 자료는 pdf로 [다운](https://drive.google.com/file/d/1tBHavj2v8GgsdOx4UMIYRN9lGvcDWejQ/view?usp=sharing) 받을 수 있다.  

## 2. Least Squares Approach 소개 및 장점  

현재 Point cloud registration을 3번에 걸쳐 진행하고 있다.  

[첫 번째 강의](https://taeyoung96.github.io/slam/SLAM_03_1/)에선 두 Point cloud 집합의 Correspondence를 알고 있을 때, Registration을 하는 방법을 배웠고, [두 번째 강의](https://taeyoung96.github.io/slam/SLAM_03_2/)에선 두 Point cloud 집합의 Correspondence를 모를 때 추정하는 방법과 조금 더 Robust한 ICP 알고리즘에 대해 배웠다.  

이번엔 Parameter를 찾는 방법을 SVD 알고리즘을 사용하는 것이 아닌 Least squares 접근 방법을 사용하여 Rotation matrix $R$과 Translation vector $t$를 구하는 방법에 대해서 배운다.  

Least squares는 [Slam 2강 (Least Squares - An Informal Introduction) 요약](https://taeyoung96.github.io/slam/SLAM_02/#2-least-squares%EB%9E%80) 에서 다루었으니 참고해보도록 하자.  

그렇다면 SVD로 푸는 방법보다 Least squares 접근 방법으로 푸는 것이 어떤 장점이 있을까?  

이에 대해 강의에서는 다음과 같은 이유를 말하고 있다.  

1. SVD solution은 point-to-point correspondences를 가정한다.  
2. Error function이 복잡해지면 복잡해질 수록, Least squares 접근 방법이 요구된다.  
3. 불확실성(Uncertainties)에 대해서 더 좋은 결과를 보인다. (Robust하다.)  
4. Alignment를 진행할 때 서로 다른 Weight를 활용하여 Alignment를 더 잘 할 수 있다.  

그렇다면 어떠한 방식으로 Least squares를 사용해서 Point cloud registration이 되는지 2D point-to-point registration을 통해서 이해해보자.  

## 3. 2D point-to-point registration  

우리가 결국 구해야 하는 것은 **Rotation matrix $R$과 Translation vector $t$** 이다.  
SVD를 사용하는 것이 아닌 Gauss Newton Minimization을 사용하여 최적화를 진행해보자.  

우선 사용한 수식은 아래와 같다.  

<p align="center"><img src="https://user-images.githubusercontent.com/41863759/150261684-3f277d19-9ba7-4413-bdb3-53518b8d1929.png" width = "600" ></p>  

위 식에서 우리가 사용하는 error function은 Rotation Matirx에 Sine과 Cosine에 관한 값이 들어가 있기 때문에, **Non-linear한 error function**이라고 할 수 있다.  

따라서 이를 선형화해주는 작업이 필요하다.  
Gauss Newton Method에서 했던 것과 마찬가지로 먼저 1차 미분에 대한 식을 구하기 위해 Jacobian을 알아야 한다.  

여기서 Jacobian의 형태는 2x3 행렬이다. 2는 x성분 y성분을 의미하고 3은 parameter의 갯수$(t_x, t_y, \theta)$를 의미한다.  

Jacobian에 대한 식은 아래와 같다.  

<p align="center"><img src="https://user-images.githubusercontent.com/41863759/150274615-24c55383-f3a7-47dc-b3f1-d1ed9cfc4c7e.png" width = "400" ></p>  

<p align="center"><img src="https://user-images.githubusercontent.com/41863759/150277640-c720e4c8-2c68-4b75-b7ea-8b96bd531e1f.png" width = "500" ></p>  

강의 자료에서 맨 마지막에 행렬을 표현할 때 $x_n, y_n$은 Error function에 있는 $x_n$의 성분을 x성분과 y성분으로 나누어서 쓴 것이니 주의하자.  

다음 Gauss Newton Method를 이용해서 최적의 해를 구하는 과정을 거친다.  

